#==============================================================================================================
# This program applies MAGMA gene-based test on data
# you may need to change these adresses: directocy ./data/NCBI38/NCBI38.gene.loc and ./data/g1000_eur/g1000_eur
# input:
#	N=5023 equal to the all samples in the study, cases and controls
#	./scDRS/output/PSC_WES_SAIGE_for_MAGMA.txt
#	./scDRS/output/PSC_WES_SAIGE_for_step2.txt
#	./scDRS/output/PSC_WES_SAIGE_step1.genes.annot
# output:
#	./scDRS/output/PSC_WES_SAIGE_step1
#	./scDRS/output/PSC_WES_SAIGE_step2
#==============================================================================================================
#!/bin/bash

annot_file="./scDRS/output/PSC_WES_SAIGE_for_MAGMA.txt"
step1_out="./scDRS/output/PSC_WES_SAIGE_step1"
step2_pval="./scDRS/output/PSC_WES_SAIGE_for_step2.txt"
step1_genes_annot="./scDRS/output/PSC_WES_SAIGE_step1.genes.annot"
step2_out="./scDRS/output/PSC_WES_SAIGE_step2"

magma --annotate --snp-loc $annot_file --gene-loc ./data/NCBI38/NCBI38.gene.loc --out $step1_out
magma --bfile ./data/g1000_eur/g1000_eur --pval $step2_pval N=5023 --gene-annot $step1_genes_annot --out $step2_out
